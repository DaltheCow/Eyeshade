!function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=44)}({43:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getStorageAll=e.setStorage=e.getStorage=void 0;e.getStorage=(t,e)=>{const n="settings"===t?chrome.storage.sync:chrome.storage.local;let i=new Promise(e=>{n.get(t,t=>e(t))});return e?i.then(e):i};e.setStorage=(t,e,n)=>{const i="settings"===t?chrome.storage.sync:chrome.storage.local;let r=new Promise(n=>{i.set(e,()=>{i.get(t,t=>n(t))})});return n?r.then(n):r};e.getStorageAll=(t,e)=>{const n=t.map(t=>({key:t,storage:chrome.storage["settings"===t?"sync":"local"]}));let i=Promise.all(n.map(t=>{const{storage:e,key:n}=t;return new Promise(t=>{e.get(n,e=>t(e))})})).then(e=>{const n={};return e.forEach((e,i)=>n[t[i]]=e[t[i]]),n});return e?i.then(e):i}},44:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RedirectEnum=void 0;const i=n(43);var r;!function(t){t.URL="URL",t.BLANK="BLANK",t.ENCOURAGING="ENCOURAGING",t.OFFENSIVE="OFFENSIVE",t.CUSTOM="CUSTOM"}(r=e.RedirectEnum||(e.RedirectEnum={})),(0,i.getStorageAll)(["settings"]).then(t=>{!function(t,e){let n=t.settings||{},{isBlocking:o,siteList:s,isWhiteListing:c,whiteListSites:a,redirectLink:u,redirectOption:l}=n;o=Boolean(o),c=Boolean(c),s=void 0===s?[]:s,a=void 0===a?[]:a,u=u||"",l=l||r.BLANK;const g={isBlocking:o,siteList:s,isWhiteListing:c,whiteListSites:a,redirectLink:u,redirectOption:l};let d={};(0,i.setStorage)("settings",{settings:g}).then(t=>{d=Object.assign(d,t),e(d)})}(t,t=>{const{isBlocking:e,isWhiteListing:n,siteList:i,whiteListSites:r,redirectLink:s,redirectOption:c}=t.settings;(e||n)&&chrome.tabs.query({},(function(t){const e=n?r:i;Array.from(t).forEach(t=>{o(t.id,t.url,e,n,s,c)})}))})}),chrome.tabs.onUpdated.addListener((function(t,e){(0,i.getStorage)("settings",(function(n){const{isBlocking:i,isWhiteListing:r,siteList:s,whiteListSites:c,redirectLink:a,redirectOption:u}=n.settings;if((i||r)&&e.url){const n=r?c:s;o(t,e.url,n,r,a,u)}}))})),chrome.storage.onChanged.addListener((function(t,e){if(t.settings){const{oldValue:e,newValue:n}=t.settings;if(e&&n){const{isBlocking:t,siteList:e,isWhiteListing:i,whiteListSites:r,redirectLink:s,redirectOption:c}=n;(t||i)&&chrome.tabs.query({},(function(t){const n=i?r:e;Array.from(t).forEach(t=>{o(t.id,t.url,n,i,s,c)})}))}}}));function o(t,e,n,i=!1,o,s){if((t=>["chrome-extension://","chrome:"].some(e=>0===t.indexOf(e)))(e))return;const c=n.find(t=>0===e.indexOf("https://"+t)||0===e.indexOf("http://"+t));if(c&&!i||!c&&i){const e=s===r.URL&&o?"https://"+o:"not_available/not_available.html";chrome.tabs.update(t,{url:e})}}}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vbW9kdWxlcy9zdG9yYWdlLnRzIiwid2VicGFjazovLy8uL2JhY2tncm91bmQvaW5kZXgudHMiXSwibmFtZXMiOlsiaW5zdGFsbGVkTW9kdWxlcyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImV4cG9ydHMiLCJtb2R1bGUiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJnZXRTdG9yYWdlIiwiY2FsbGJhY2siLCJzdG9yYWdlIiwiY2hyb21lIiwic3luYyIsImxvY2FsIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwiZGF0YSIsInRoZW4iLCJzZXRTdG9yYWdlIiwic2V0IiwiZ2V0U3RvcmFnZUFsbCIsImtleXMiLCJzdG9yYWdlc0tleXMiLCJtYXAiLCJhbGwiLCJzdG9yYWdlS2V5IiwicmVzIiwiZm9yRWFjaCIsIml0ZW0iLCJpZHgiLCJSZWRpcmVjdEVudW0iLCJwcmV2U2V0dGluZ3MiLCJzZXR0aW5ncyIsImlzQmxvY2tpbmciLCJzaXRlTGlzdCIsImlzV2hpdGVMaXN0aW5nIiwid2hpdGVMaXN0U2l0ZXMiLCJyZWRpcmVjdExpbmsiLCJyZWRpcmVjdE9wdGlvbiIsIkJvb2xlYW4iLCJ1bmRlZmluZWQiLCJCTEFOSyIsIm5ld0RhdGEiLCJhc3NpZ24iLCJlbnN1cmVTZXR0aW5ncyIsInRhYnMiLCJxdWVyeSIsInNpdGVzIiwiQXJyYXkiLCJmcm9tIiwidGFiIiwiYmxvY2tTaXRlcyIsImlkIiwidXJsIiwib25VcGRhdGVkIiwiYWRkTGlzdGVuZXIiLCJ0YWJJZCIsImNoYW5nZUluZm8iLCJvbkNoYW5nZWQiLCJjaGFuZ2VzIiwibmFtZXNwYWNlIiwib2xkVmFsdWUiLCJuZXdWYWx1ZSIsIm5Jc0Jsb2NraW5nIiwiblNpdGVMaXN0IiwibklzV2hpdGVMaXN0aW5nIiwibldoaXRlTGlzdFNpdGVzIiwiaXNXaGl0ZWxpc3QiLCJzb21lIiwic2l0ZSIsImluZGV4T2YiLCJpZ25vcmVTaXRlIiwiaXNJbkxpc3QiLCJmaW5kIiwiVVJMIiwidXBkYXRlIl0sIm1hcHBpbmdzIjoiYUFDRSxJQUFJQSxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVQyxRQUduQyxJQUFJQyxFQUFTSixFQUFpQkUsR0FBWSxDQUN6Q0csRUFBR0gsRUFDSEksR0FBRyxFQUNISCxRQUFTLElBVVYsT0FOQUksRUFBUUwsR0FBVU0sS0FBS0osRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU0YsR0FHL0RHLEVBQU9FLEdBQUksRUFHSkYsRUFBT0QsUUFLZkYsRUFBb0JRLEVBQUlGLEVBR3hCTixFQUFvQlMsRUFBSVYsRUFHeEJDLEVBQW9CVSxFQUFJLFNBQVNSLEVBQVNTLEVBQU1DLEdBQzNDWixFQUFvQmEsRUFBRVgsRUFBU1MsSUFDbENHLE9BQU9DLGVBQWViLEVBQVNTLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVosRUFBb0JrQixFQUFJLFNBQVNoQixHQUNYLG9CQUFYaUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlYixFQUFTaUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlYixFQUFTLGFBQWMsQ0FBRW1CLE9BQU8sS0FRdkRyQixFQUFvQnNCLEVBQUksU0FBU0QsRUFBT0UsR0FFdkMsR0FEVSxFQUFQQSxJQUFVRixFQUFRckIsRUFBb0JxQixJQUMv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LEVBQ1Y3QixlQUFnQjhCLEVBQ2hCN0IsZUFBZ0I4QixFQUFlLGFBQy9CN0IsRUFBWSxlQUNaQyxHQUNFd0IsR0FFaUJDLEdBQWVFLElBRWxDdkQsT0FBT21DLEtBQUtDLE1BQU0sSUFBSSxTQUFVRCxHQUM5QixNQUFNWCxFQUFXK0IsRUFBa0JDLEVBQWtCRixFQUNyRGhCLE1BQU1DLEtBQUtKLEdBQU1sQixRQUFTdUIsSUFDeEJDLEVBQVdELEVBQUlFLEdBQUlGLEVBQUlHLElBQUtuQixFQUFVK0IsRUFBaUI1QixFQUFjQyxhQWNqRixTQUFTYSxFQUNQSyxFQUNBSCxFQUNBbkIsRUFDQWlDLEdBQWMsRUFDZDlCLEVBQ0FDLEdBRUEsR0FiaUIsQ0FBQ2UsR0FDRSxDQUFDLHNCQUF1QixXQUN6QmUsS0FBTUMsR0FBK0IsSUFBdEJoQixFQUFJaUIsUUFBUUQsSUFXMUNFLENBQVdsQixHQUFNLE9BQ3JCLE1BQU1tQixFQUFXdEMsRUFBU3VDLEtBQU1KLEdBQ1ksSUFBbkNoQixFQUFJaUIsUUFBUSxXQUFhRCxJQUFpRCxJQUFsQ2hCLEVBQUlpQixRQUFRLFVBQVlELElBR3pFLEdBRHlCRyxJQUFhTCxJQUFrQkssR0FBWUwsRUFDL0MsQ0FFbkIsTUFBTWQsRUFDSmYsSUFBbUJSLEVBQWE0QyxLQUFPckMsRUFDbkMsV0FBYUEsRUFDYixtQ0FDTjNCLE9BQU9tQyxLQUFLOEIsT0FBT25CLEVBQU8sQ0FBRUgiLCJmaWxlIjoiYmFja2dyb3VuZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSA0NCk7XG4iLCJleHBvcnQgY29uc3QgZ2V0U3RvcmFnZSA9IChrZXk6IHN0cmluZywgY2FsbGJhY2s/OiBhbnkpID0+IHtcbiAgY29uc3Qgc3RvcmFnZSA9IGtleSA9PT0gXCJzZXR0aW5nc1wiID8gY2hyb21lLnN0b3JhZ2Uuc3luYyA6IGNocm9tZS5zdG9yYWdlLmxvY2FsO1xuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc3RvcmFnZS5nZXQoa2V5LCAoZGF0YSkgPT4gcmVzb2x2ZShkYXRhKSk7XG4gIH0pO1xuICByZXR1cm4gY2FsbGJhY2sgPyBwcm9taXNlLnRoZW4oY2FsbGJhY2spIDogcHJvbWlzZTtcbn07XG5cbmV4cG9ydCBjb25zdCBzZXRTdG9yYWdlID0gKGtleTogc3RyaW5nLCBvYmplY3Q6IGFueSwgY2FsbGJhY2s/OiBhbnkpID0+IHtcbiAgY29uc3Qgc3RvcmFnZSA9IGtleSA9PT0gXCJzZXR0aW5nc1wiID8gY2hyb21lLnN0b3JhZ2Uuc3luYyA6IGNocm9tZS5zdG9yYWdlLmxvY2FsO1xuICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc3RvcmFnZS5zZXQob2JqZWN0LCAoKSA9PiB7XG4gICAgICBzdG9yYWdlLmdldChrZXksIChkYXRhKSA9PiB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKGRhdGEpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuICByZXR1cm4gY2FsbGJhY2sgPyBwcm9taXNlLnRoZW4oY2FsbGJhY2spIDogcHJvbWlzZTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRTdG9yYWdlQWxsID0gKGtleXM6IGFueSwgY2FsbGJhY2s/OiBhbnkpID0+IHtcbiAgY29uc3Qgc3RvcmFnZXNLZXlzID0ga2V5cy5tYXAoKGtleTogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIHsga2V5LCBzdG9yYWdlOiBjaHJvbWUuc3RvcmFnZVtrZXkgPT09IFwic2V0dGluZ3NcIiA/IFwic3luY1wiIDogXCJsb2NhbFwiXSB9O1xuICB9KTtcbiAgbGV0IHByb21pc2UgPSBQcm9taXNlLmFsbChcbiAgICBzdG9yYWdlc0tleXMubWFwKChzdG9yYWdlS2V5OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IHsgc3RvcmFnZSwga2V5IH0gPSBzdG9yYWdlS2V5O1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHN0b3JhZ2UuZ2V0KGtleSwgKGRhdGE6IGFueSkgPT4gcmVzb2x2ZShkYXRhKSk7XG4gICAgICB9KTtcbiAgICB9KVxuICApLnRoZW4oKHJlcykgPT4ge1xuICAgIGNvbnN0IGRhdGEgPSB7fSBhcyBhbnk7XG4gICAgcmVzLmZvckVhY2goKGl0ZW0sIGlkeCkgPT4gKGRhdGFba2V5c1tpZHhdXSA9IGl0ZW1ba2V5c1tpZHhdXSkpO1xuICAgIHJldHVybiBkYXRhO1xuICB9KTtcbiAgcmV0dXJuIGNhbGxiYWNrID8gcHJvbWlzZS50aGVuKGNhbGxiYWNrKSA6IHByb21pc2U7XG59O1xuIiwiaW1wb3J0IHsgZ2V0U3RvcmFnZSwgc2V0U3RvcmFnZSwgZ2V0U3RvcmFnZUFsbCB9IGZyb20gXCIuLi9tb2R1bGVzL3N0b3JhZ2VcIjtcblxuZXhwb3J0IGVudW0gUmVkaXJlY3RFbnVtIHtcbiAgVVJMID0gXCJVUkxcIixcbiAgQkxBTksgPSBcIkJMQU5LXCIsXG4gIEVOQ09VUkFHSU5HID0gXCJFTkNPVVJBR0lOR1wiLFxuICBPRkZFTlNJVkUgPSBcIk9GRkVOU0lWRVwiLFxuICBDVVNUT00gPSBcIkNVU1RPTVwiLFxufVxuXG5leHBvcnQgdHlwZSBUaXAgPSB7XG4gIHRpdGxlOiBzdHJpbmc7XG4gIHRleHQ6IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIFRpcFNldHRpbmdzID0ge1xuICB0aXBzOiBUaXBbXTtcbiAgdGhlbWU6IHtcbiAgICBjb2xvcjoge1xuICAgICAgYmFja2dyb3VuZFN0YXJ0OiBzdHJpbmc7XG4gICAgICBiYWNrZ3JvdW5kRW5kOiBzdHJpbmc7XG4gICAgICBmb250RmFtaWx5OiBzdHJpbmc7XG4gICAgICBmb250Q29sb3I6IHN0cmluZztcbiAgICB9O1xuICB9O1xufTtcblxuZXhwb3J0IHR5cGUgU2V0dGluZ3MgPSB7XG4gIGlzQmxvY2tpbmc/OiBib29sZWFuO1xuICBpc1doaXRlTGlzdGluZz86IGJvb2xlYW47XG4gIHNpdGVMaXN0Pzogc3RyaW5nW107XG4gIHdoaXRlTGlzdFNpdGVzPzogc3RyaW5nW107XG4gIHJlZGlyZWN0TGluaz86IHN0cmluZztcbiAgcmVkaXJlY3RPcHRpb24/OiBSZWRpcmVjdEVudW07XG4gIHRpcFNldHRpbmdzPzogVGlwU2V0dGluZ3M7XG59O1xuXG4oZnVuY3Rpb24gKCkge1xuICBnZXRTdG9yYWdlQWxsKFtcInNldHRpbmdzXCJdKS50aGVuKChkYXRhKSA9PiB7XG4gICAgZW5zdXJlU2V0dGluZ3MoZGF0YSwgKG5ld0RhdGE6IGFueSkgPT4ge1xuICAgICAgY29uc3QgeyBpc0Jsb2NraW5nLCBpc1doaXRlTGlzdGluZywgc2l0ZUxpc3QsIHdoaXRlTGlzdFNpdGVzLCByZWRpcmVjdExpbmssIHJlZGlyZWN0T3B0aW9uIH0gPVxuICAgICAgICBuZXdEYXRhLnNldHRpbmdzIGFzIFNldHRpbmdzO1xuICAgICAgaWYgKGlzQmxvY2tpbmcgfHwgaXNXaGl0ZUxpc3RpbmcpIHtcbiAgICAgICAgY2hyb21lLnRhYnMucXVlcnkoe30sIGZ1bmN0aW9uICh0YWJzKSB7XG4gICAgICAgICAgY29uc3Qgc2l0ZXMgPSBpc1doaXRlTGlzdGluZyA/IHdoaXRlTGlzdFNpdGVzIDogc2l0ZUxpc3Q7XG4gICAgICAgICAgQXJyYXkuZnJvbSh0YWJzKS5mb3JFYWNoKCh0YWIpID0+IHtcbiAgICAgICAgICAgIGJsb2NrU2l0ZXModGFiLmlkLCB0YWIudXJsLCBzaXRlcywgaXNXaGl0ZUxpc3RpbmcsIHJlZGlyZWN0TGluaywgcmVkaXJlY3RPcHRpb24pO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KSgpO1xuXG5jaHJvbWUudGFicy5vblVwZGF0ZWQuYWRkTGlzdGVuZXIoZnVuY3Rpb24gKHRhYklkLCBjaGFuZ2VJbmZvKSB7XG4gIGdldFN0b3JhZ2UoXCJzZXR0aW5nc1wiLCBmdW5jdGlvbiAoZGF0YTogYW55KSB7XG4gICAgY29uc3QgeyBpc0Jsb2NraW5nLCBpc1doaXRlTGlzdGluZywgc2l0ZUxpc3QsIHdoaXRlTGlzdFNpdGVzLCByZWRpcmVjdExpbmssIHJlZGlyZWN0T3B0aW9uIH0gPVxuICAgICAgZGF0YS5zZXR0aW5ncztcbiAgICBpZiAoKGlzQmxvY2tpbmcgfHwgaXNXaGl0ZUxpc3RpbmcpICYmIGNoYW5nZUluZm8udXJsKSB7XG4gICAgICBjb25zdCBzaXRlcyA9IGlzV2hpdGVMaXN0aW5nID8gd2hpdGVMaXN0U2l0ZXMgOiBzaXRlTGlzdDtcbiAgICAgIGJsb2NrU2l0ZXModGFiSWQsIGNoYW5nZUluZm8udXJsLCBzaXRlcywgaXNXaGl0ZUxpc3RpbmcsIHJlZGlyZWN0TGluaywgcmVkaXJlY3RPcHRpb24pO1xuICAgIH1cbiAgfSk7XG59KTtcblxuY2hyb21lLnN0b3JhZ2Uub25DaGFuZ2VkLmFkZExpc3RlbmVyKGZ1bmN0aW9uIChjaGFuZ2VzLCBuYW1lc3BhY2UpIHtcbiAgaWYgKGNoYW5nZXMuc2V0dGluZ3MpIHtcbiAgICBjb25zdCB7IG9sZFZhbHVlLCBuZXdWYWx1ZSB9ID0gY2hhbmdlcy5zZXR0aW5ncztcbiAgICBpZiAob2xkVmFsdWUgJiYgbmV3VmFsdWUpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgaXNCbG9ja2luZzogbklzQmxvY2tpbmcsXG4gICAgICAgIHNpdGVMaXN0OiBuU2l0ZUxpc3QsXG4gICAgICAgIGlzV2hpdGVMaXN0aW5nOiBuSXNXaGl0ZUxpc3RpbmcsXG4gICAgICAgIHdoaXRlTGlzdFNpdGVzOiBuV2hpdGVMaXN0U2l0ZXMsXG4gICAgICAgIHJlZGlyZWN0TGluayxcbiAgICAgICAgcmVkaXJlY3RPcHRpb24sXG4gICAgICB9ID0gbmV3VmFsdWU7XG4gICAgICAvLyBUT0RPIGluIGZ1dHVyZSBjYW4gbWFrZSBpdCBwb3NzaWJsZSB0byB0dXJuIG9mZiBibG9jayBzaXRlcyBhbmQgdGhlbiBhbnkgcGFnZSB3b3VsZCBnbyBiYWNrIHRvIHdoYXQgd2FzIG9yaWdpbmFsbHkgc2VhcmNoZWQgKGlmIEkgc2F2ZSBzZWFyY2hlZCB2aWQgcGVyIHRhYiBwcmlvciB0byBibG9ja2luZyBzYWlkIHBhZ2UpXG4gICAgICBjb25zdCBibG9ja0VuYWJsZWQgPSBuSXNCbG9ja2luZyB8fCBuSXNXaGl0ZUxpc3Rpbmc7XG4gICAgICBpZiAoYmxvY2tFbmFibGVkKSB7XG4gICAgICAgIGNocm9tZS50YWJzLnF1ZXJ5KHt9LCBmdW5jdGlvbiAodGFicykge1xuICAgICAgICAgIGNvbnN0IHNpdGVMaXN0ID0gbklzV2hpdGVMaXN0aW5nID8gbldoaXRlTGlzdFNpdGVzIDogblNpdGVMaXN0O1xuICAgICAgICAgIEFycmF5LmZyb20odGFicykuZm9yRWFjaCgodGFiKSA9PiB7XG4gICAgICAgICAgICBibG9ja1NpdGVzKHRhYi5pZCwgdGFiLnVybCwgc2l0ZUxpc3QsIG5Jc1doaXRlTGlzdGluZywgcmVkaXJlY3RMaW5rLCByZWRpcmVjdE9wdGlvbik7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfVxufSk7XG5cbi8vIG5ldmVyIGJsb2NrIHNpdGVzIHdpdGggdGhlc2UgdGVybXNcbmNvbnN0IGlnbm9yZVNpdGUgPSAodXJsOiBzdHJpbmcpID0+IHtcbiAgY29uc3QgaWdub3JlU2l0ZXMgPSBbXCJjaHJvbWUtZXh0ZW5zaW9uOi8vXCIsIFwiY2hyb21lOlwiXTtcbiAgcmV0dXJuIGlnbm9yZVNpdGVzLnNvbWUoKHNpdGUpID0+IHVybC5pbmRleE9mKHNpdGUpID09PSAwKTtcbn07XG5cbmZ1bmN0aW9uIGJsb2NrU2l0ZXMoXG4gIHRhYklkOiBhbnksXG4gIHVybDogc3RyaW5nLFxuICBzaXRlTGlzdDogc3RyaW5nW10sXG4gIGlzV2hpdGVsaXN0ID0gZmFsc2UsXG4gIHJlZGlyZWN0TGluazogc3RyaW5nLFxuICByZWRpcmVjdE9wdGlvbjogUmVkaXJlY3RFbnVtXG4pIHtcbiAgaWYgKGlnbm9yZVNpdGUodXJsKSkgcmV0dXJuO1xuICBjb25zdCBpc0luTGlzdCA9IHNpdGVMaXN0LmZpbmQoKHNpdGUpID0+IHtcbiAgICByZXR1cm4gdXJsLmluZGV4T2YoXCJodHRwczovL1wiICsgc2l0ZSkgPT09IDAgfHwgdXJsLmluZGV4T2YoXCJodHRwOi8vXCIgKyBzaXRlKSA9PT0gMDtcbiAgfSk7XG4gIGNvbnN0IHNob3VsZEJlQmxvY2tlZCA9IChpc0luTGlzdCAmJiAhaXNXaGl0ZWxpc3QpIHx8ICghaXNJbkxpc3QgJiYgaXNXaGl0ZWxpc3QpO1xuICBpZiAoc2hvdWxkQmVCbG9ja2VkKSB7XG4gICAgLy8gY2FuIEkgcHVzaCB0aGUgY3VycmVudCB1cmwgb250byBoaXN0b3J5IHNvIGl0IGlzbid0IGxvc3QgYmVmb3JlIHJlZGlyZWN0P1xuICAgIGNvbnN0IHVybCA9XG4gICAgICByZWRpcmVjdE9wdGlvbiA9PT0gUmVkaXJlY3RFbnVtLlVSTCAmJiByZWRpcmVjdExpbmtcbiAgICAgICAgPyBcImh0dHBzOi8vXCIgKyByZWRpcmVjdExpbmtcbiAgICAgICAgOiBcIm5vdF9hdmFpbGFibGUvbm90X2F2YWlsYWJsZS5odG1sXCI7XG4gICAgY2hyb21lLnRhYnMudXBkYXRlKHRhYklkLCB7IHVybCB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBlbnN1cmVTZXR0aW5ncyhkYXRhOiBhbnksIGNhbGxiYWNrOiBhbnkpIHtcbiAgbGV0IHByZXZTZXR0aW5ncyA9IGRhdGEuc2V0dGluZ3MgfHwge307XG5cbiAgbGV0IHsgaXNCbG9ja2luZywgc2l0ZUxpc3QsIGlzV2hpdGVMaXN0aW5nLCB3aGl0ZUxpc3RTaXRlcywgcmVkaXJlY3RMaW5rLCByZWRpcmVjdE9wdGlvbiB9ID1cbiAgICBwcmV2U2V0dGluZ3M7XG5cbiAgaXNCbG9ja2luZyA9IEJvb2xlYW4oaXNCbG9ja2luZyk7XG4gIGlzV2hpdGVMaXN0aW5nID0gQm9vbGVhbihpc1doaXRlTGlzdGluZyk7XG4gIHNpdGVMaXN0ID0gc2l0ZUxpc3QgPT09IHVuZGVmaW5lZCA/IFtdIDogc2l0ZUxpc3Q7XG4gIHdoaXRlTGlzdFNpdGVzID0gd2hpdGVMaXN0U2l0ZXMgPT09IHVuZGVmaW5lZCA/IFtdIDogd2hpdGVMaXN0U2l0ZXM7XG4gIHJlZGlyZWN0TGluayA9IHJlZGlyZWN0TGluayB8fCBcIlwiO1xuICByZWRpcmVjdE9wdGlvbiA9IHJlZGlyZWN0T3B0aW9uIHx8IFJlZGlyZWN0RW51bS5CTEFOSztcbiAgY29uc3Qgc2V0dGluZ3MgPSB7XG4gICAgaXNCbG9ja2luZyxcbiAgICBzaXRlTGlzdCxcbiAgICBpc1doaXRlTGlzdGluZyxcbiAgICB3aGl0ZUxpc3RTaXRlcyxcbiAgICByZWRpcmVjdExpbmssXG4gICAgcmVkaXJlY3RPcHRpb24sXG4gIH07XG4gIC8vdXBkYXRlIHN0b3JhZ2UgdXNlIHRvIG5ldyBzZXQgZnVuY3Rpb25cbiAgbGV0IG5ld0RhdGEgPSB7fTtcbiAgc2V0U3RvcmFnZShcInNldHRpbmdzXCIsIHsgc2V0dGluZ3MgfSkudGhlbigoZGF0YSkgPT4ge1xuICAgIG5ld0RhdGEgPSBPYmplY3QuYXNzaWduKG5ld0RhdGEsIGRhdGEpO1xuICAgIGNhbGxiYWNrKG5ld0RhdGEpO1xuICB9KTtcbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=